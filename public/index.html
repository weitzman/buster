<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Buster</title>

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>

    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">

    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap-theme.min.css" integrity="sha384-fLW2N01lMqjakBkx3l/M9EahuwpSfeNvV63J5ezn3uZzapT0u7EYsXMjQV+0En5r" crossorigin="anonymous">

    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>

    <!--<link href="http://kendo.cdn.telerik.com/2014.2.716/styles/kendo.common.min.css" rel="stylesheet" />-->
    <!--<link href="http://kendo.cdn.telerik.com/2014.2.716/styles/kendo.default.min.css" rel="stylesheet" />-->
    <!--<script src="http://kendo.cdn.telerik.com/2014.2.716/js/jquery.min.js"></script>-->
    <script src="https://kendo.cdn.telerik.com/2014.2.716/js/kendo.ui.core.min.js"></script>
    <link rel="stylesheet" href="https://kendo.cdn.telerik.com/2014.2.716/styles/kendo.common-bootstrap.min.css">
    <link rel="stylesheet" href="https://kendo.cdn.telerik.com/2014.2.716/styles/kendo.bootstrap.min.css">

    <!-- Custom styles for this template -->
    <link href="cover.css" rel="stylesheet">
</head>
<body>
    <div class="site-wrapper">

        <div class="site-wrapper-inner">

            <div class="cover-container">

                <div class="masthead clearfix">
                    <div class="inner">
                        <h3 class="masthead-brand">Cover</h3>
                        <nav>
                            <ul class="nav masthead-nav">
                                <li class="active"><a href="#">Home</a></li>
                                <li><a href="#">Features</a></li>
                                <li><a href="#">Contact</a></li>
                            </ul>
                        </nav>
                    </div>
                </div>

                <div class="inner cover">
                    <h1 class="cover-heading">Choose a bus stop.</h1>


                    <div id="example">


                        <div class="demo-section k-content">
                            <ul id="fieldlist">
                                <li>
                                    <label for="categories">Transit System</label>
                                    <input id="categories" style="width: 100%;" />
                                </li>
                                <li>
                                    <label for="products">Routes</label>
                                    <input id="products" disabled="disabled" style="width: 100%;" />
                                </li>
                                <li>
                                    <label for="orders">Stops</label>
                                    <input id="orders" disabled="disabled" style="width: 100%;" />
                                </li>
                                <li>
                                    <button class="k-button k-primary" id="get">View Order</button>
                                </li>
                            </ul>
                        </div>

                        <style>
                            #fieldlist {
                                margin: 0;
                                padding: 0;
                            }

                            #fieldlist li {
                                list-style: none;
                                padding-bottom: 1.5em;
                                text-align: left;
                            }

                            #fieldlist label {
                                display: block;
                                padding-bottom: .3em;
                                /*font-weight: bold;*/
                                /*text-transform: uppercase;*/
                                /*font-size: 12px;*/
                            }
                        </style>

                        <script>
                            $(document).ready(function() {
                                var categories = $("#categories").kendoComboBox({
//                                    filter: "contains",
                                    placeholder: "Select a Transit system ...",
                                    dataTextField: "title",
                                    dataValueField: "tag",
                                    dataSource: {
                                        type: "xml",
                                        serverFiltering: true,
                                        transport: {
                                            read: "http://webservices.nextbus.com/service/publicXMLFeed?command=agencyList"
                                        },
                                        schema: {
                                            // specify the the schema is XML
                                            type: "xml",
                                            // the XML element which represents a single data record
                                            data: "/body/agency",
                                            // define the model - the object which will represent a single data record
                                            model: {
                                                // configure the fields of the object
                                                fields: {
                                                    title: "@title",
                                                    tag: "@tag",
                                                    regionTitle: "@regionTitle",
                                                }
                                            }
                                        },
                                    }
                                }).data("kendoComboBox");

                                var products = $("#products").kendoComboBox({
                                    autoBind: false,
                                    cascadeFrom: "categories",
                                    serverFiltering: true,
//                                  filter: "contains",
                                    placeholder: "Select a route...",
                                    dataTextField: "title",
                                    dataValueField: "tag",
                                    dataSource: {
                                        type: "xml",
                                        serverFiltering: true,
                                        transport: {
                                           read: {
                                               url: function (options) {
//                                                   console.log(options);
                                                   return "http://webservices.nextbus.com/service/publicXMLFeed?command=routeList&a=" + options.filter.filters[0].value;
                                               },
                                           }
                                        },
                                        schema: {
                                            // specify the the schema is XML
                                            type: "xml",
                                            // the XML element which represents a single data record
                                            data: "/body/route",
                                            // define the model - the object which will represent a single data record
                                            model: {
                                                // configure the fields of the object
                                                fields: {
                                                    title: "@title",
                                                    tag: "@tag",
                                                }
                                            }
                                        },
                                    }
                                }).data("kendoComboBox");

                                var orders = $("#orders").kendoComboBox({
                                    autoBind: false,
                                    cascadeFrom: "products",
//                                    filter: "contains",
                                    placeholder: "Select a stop...",
                                    dataTextField: "title",
                                    dataValueField: "tag",
                                    dataSource: {
                                        type: "xml",
                                        serverFiltering: true,
                                        transport: {
                                            read: {
                                                url: function (options) {
                                                    console.log(options);
                                                    var agency = categories.value();
                                                    var route = options.filter.filters[0].value;
                                                    return "http://webservices.nextbus.com/service/publicXMLFeed?command=routeConfig&a=" + agency + "&r=" + route;
                                                },
                                            }
                                        },
                                        schema: {
                                            // specify the the schema is XML
                                            type: "xml",
                                            // the XML element which represents a single data record
                                            data: "/body/route/stop",
                                            // define the model - the object which will represent a single data record
                                            model: {
                                                // configure the fields of the object
                                                fields: {
                                                    title: "@title",
                                                    tag: "@tag",
                                                    stopId: "@stopId",
                                                }
                                            }
                                        },
                                    }
                                }).data("kendoComboBox");

                                $("#get").click(function() {
                                    var categoryInfo = "\nCategory: { id: " + categories.value() + ", name: " + categories.text() + " }",
                                            productInfo = "\nProduct: { id: " + products.value() + ", name: " + products.text() + " }",
                                            orderInfo = "\nOrder: { id: " + orders.value() + ", name: " + orders.text() + " }";

                                    alert("Order details:\n" + categoryInfo + productInfo + orderInfo);

                                });
                            });
                        </script>
                    </div>

                </div>

                <div class="mastfoot">
                    <div class="inner">
                        <p>Cover template for <a href="http://getbootstrap.com">Bootstrap</a>, by <a href="https://twitter.com/mdo">@mdo</a>.</p>
                    </div>
                </div>

            </div>

        </div>

    </div>

</body>
</html>
